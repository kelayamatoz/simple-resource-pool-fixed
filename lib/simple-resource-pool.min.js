!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("simple-resource-pool",[],t):"object"==typeof exports?exports["simple-resource-pool"]=t():e.SimpleResourcePool=t()}(this,function(){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var o=function(){function e(e,t){if(void 0===t&&(t=Number.MAX_SAFE_INTEGER-1),this.availables=[],this.busies=[],this.debts=[],e()==e())throw new Error("Creator function returns the same object on diff calls");if(!Number.isInteger(t))throw new TypeError;if(t<1)throw new RangeError;if(t>=Number.MAX_SAFE_INTEGER)throw new RangeError;this.creator=e,this.maxResources=t}return e.prototype.getRes=function(){var e=this,t=Math.random();return this.debts.push(t),new Promise(function(r){if(e.availables.length>0){var o=e.availables.pop();e.busies.push(o),e.debts.splice(e.debts.indexOf(t),1),r(o)}else if(e.resCount()<e.maxResources){o=e.creator();e.busies.push(o),e.debts.splice(e.debts.indexOf(t),1),r(o)}else var s=setInterval(function(){if(e.availables.length>0){var o=e.availables.pop();e.busies.push(o),e.debts.splice(e.debts.indexOf(t),1),clearInterval(s),r(o)}},0)})},e.prototype.release=function(e){var t=this.busies.indexOf(e);this.busies.splice(t,1),this.availables.push(e)},e.prototype.resCount=function(){return this.busies.length+this.availables.length},e}();r.d(t,"ResourcePool",function(){return o})}])});